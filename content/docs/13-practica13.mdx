---
title: "Pr√°ctica 13"
date: 2025-11-19
order: 13
---

# Pr√°ctica 13: Preprocesamiento de Im√°genes

- **Autores:** Joaqu√≠n Batista, Milagros Cancela, Valent√≠n Rodr√≠guez, Alexia Aurrecoechea, Nahuel L√≥pez (G1)
- **Unidad tem√°tica:** UT4 ¬∑ Datos Especiales
- **Tipo:** Pr√°ctica guiada ‚Äì Assignment UT4-13
- **Entorno:** Python ¬∑ OpenCV ¬∑ scikit-image ¬∑ NumPy ¬∑ Matplotlib ¬∑ Pandas
- **Dataset:** Pack cl√°sico de `skimage` (camera, astronaut, coffee, coins, checkerboard, rocket, page)
- **Notebook:** Pr√°ctica 13 - Preprocesamiento de Im√°genes

---

## üì∏ Representaci√≥n y Diagn√≥stico Inicial

- Lectura de cada imagen en BGR, conversi√≥n a RGB/grises y c√°lculo de estad√≠sticas b√°sicas.
- Chequeos autom√°ticos: dimensiones, rango din√°mico, media y desv√≠o est√°ndar para detectar saturaciones.
- El histograma de `camera.png` ocupa 0‚Äì255 con media 115.41 ‚Üí buen uso del rango tonal sin clipping.
- En RGB domina el canal `R`, aportando un tinte c√°lido que se debe preservar en etapas posteriores.

![Histogramas iniciales y canales RGB](/practico13/ut5_hist_rgb.png)

```python
img_bgr = cv2.imread(str(img_path), cv2.IMREAD_COLOR)
img_rgb = cv2.cvtColor(img_bgr, cv2.COLOR_BGR2RGB)
img_gray = cv2.cvtColor(img_bgr, cv2.COLOR_BGR2GRAY)
height, width = img_gray.shape
print(f"H={height} W={width} rango={img_gray.min()}-{img_gray.max()} Œº={img_gray.mean():.2f}")
```

**Hallazgos:** rango din√°mico completo, histograma bimodal (alto contraste) y predominio del canal rojo que justifica defensas de color controladas.

---

## üé® Espacios de Color y Realce de Contraste

- Se compar√≥ `equalize_hist` en grises vs. CLAHE aplicado al canal `L*` en LAB para evitar alterar matices.
- M√©trica clave: desviaci√≥n est√°ndar del contraste ‚Üí `75.12` (original) `80.25` (equalize) `75.87` (CLAHE).
- CLAHE preserva detalles locales sin sobreexponer, gracias al clip limit y al procesamiento por tiles.

![Comparativa de contraste (original, equalize, CLAHE)](/practico13/ut5_contraste_comparacion.png)

```python
img_lab = cv2.cvtColor(img_bgr, cv2.COLOR_BGR2LAB)
L, A, B = cv2.split(img_lab)
clahe = cv2.createCLAHE(clipLimit=2.0, tileGridSize=(8, 8))
L_clahe = clahe.apply(L)
rgb_clahe = cv2.cvtColor(cv2.merge([L_clahe, A, B]), cv2.COLOR_LAB2RGB)
```

**Conclusiones:** el canal `L` concentra la luminancia; CLAHE ofrece el mejor balance entre realce global y protecci√≥n de texturas homog√©neas.

---

## üîß Suavizado y Detecci√≥n de Bordes

- Se aplicaron filtros gaussianos y bilaterales antes de ejecutar Canny con umbrales fijos.
- Varianza del gradiente: `10‚ÄØ788 ‚Üí 5‚ÄØ335 (gauss) ‚Üí 5‚ÄØ488 (bilateral)`; ambos reducen ruido, pero el bilateral preserva aristas finas.
- Ratio de bordes: `0.078` (original) vs `0.038` (bilateral), mostrando menos falsos positivos tras suavizado adaptativo.

![Suavizado y bordes (Gaussian vs Bilateral vs Canny)](/practico13/ut5_suavizado_bordes.png)

**Recomendaciones:** filtro bilateral para escenas con contornos delicados y ajuste de umbrales Canny a `(50, 100)` en escenarios de baja luz.

---

## ‚≠ê Puntos de Inter√©s y Matching

- Se midi√≥ la densidad y repetibilidad de keypoints ORB sobre cada variante preprocessada.
- CLAHE gener√≥ ~1‚ÄØ000 keypoints v√°lidos con repetibilidad 0.62 vs. la imagen original.
- Par√°metros sugeridos para ORB: `nfeatures=750`, `scaleFactor=1.1` para equilibrar cobertura y costo.

![Keypoints ORB por variante](/practico13/ut5_orb_keypoints.png)
![Matching ORB original vs CLAHE](/practico13/ut5_orb_matches.png)

**Conclusiones:** realzar contraste local potencia gradientes y mejora la estabilidad de features entre escenas.

---

## üìä M√©tricas de Calidad y Checks Autom√°ticos

- Reglas r√°pidas:
  - `num_keypoints < 100` ‚Üí alerta cr√≠tica (escena pobre o filtrado agresivo).
  - `edges_ratio ‚àâ [0.02, 0.15]` ‚Üí ruido o falta de bordes.
  - `std_contrast < 20` ‚Üí iluminaci√≥n deficiente.
- Estas m√©tricas alimentan un dashboard QA que destaca im√°genes problem√°ticas.

![Dashboard QA con alertas](/practico13/ut5_dashboard_qa.png)

---

## üéØ Tareas Extra

### 1. Curva Sensibilidad vs Ruido

- Barrido de `clipLimit` y `tileGridSize` para CLAHE midiendo `num_keypoints` vs. un proxy de ruido (bordes falsos en regiones lisas).
- Mejor configuraci√≥n: tiles `4√ó4` con `clipLimit=1.0`, que maximiza keypoints sin incrementar ruido.
- Suavizados gaussianos/bilaterales se mantienen estables mientras el kernel ‚â§ 11.

![Curvas sensibilidad vs ruido](/practico13/ut5_sensibilidad_ruido.png)

### 2. Benchmark ORB vs SIFT

- ORB resulta ‚âà3.5√ó m√°s r√°pido, ideal para pipelines en tiempo real.
- SIFT recupera m√°s matches absolutos, pero el ratio de matches √∫tiles se mantiene similar (0.54 vs 0.47).
- Recomendaci√≥n: usar ORB cuando prime la velocidad y SIFT cuando se privilegie la precisi√≥n.

![Benchmark ORB vs SIFT](/practico13/ut5_benchmark_orb_sift.png)

### 3. Dashboard QA

- Tablero con KPIs por imagen y alertas de repetibilidad, edges ratio y contraste.
- 7 im√°genes quedaron bajo alerta cr√≠tica (repetibilidad < 0.3) y `page.png` excedi√≥ el rango √≥ptimo de bordes (0.121).

![Dashboard QA con alertas](/practico13/ut5_dashboard_qa.png)

---

## üß† Conclusiones Finales

- CLAHE es la transformaci√≥n m√°s √∫til: realza detalle local sin artefactos globales.
- El canal `L` en LAB es la pieza central para ajustes de contraste controlados.
- Existe un trade-off claro entre suavizado y preservaci√≥n de features; conviene calibrar filtros seg√∫n la tarea.
- Los checks autom√°ticos (`num_keypoints`, `edges_ratio`, `std_contrast`, `repeatability`) permiten detectar degradaciones tempranas y priorizar reprocesos.
- El dashboard QA acelera la revisi√≥n colaborativa y documenta decisiones de mantenimiento.

---

## ‚úÖ Checklist de Implementaci√≥n

- Diagn√≥stico inicial (histogramas RGB + grises).
- Comparaci√≥n Equalize vs CLAHE en LAB.
- Suavizado (Gaussian/Bilateral) + Canny con m√©tricas de gradiente.
- Detecci√≥n y matching de features (ORB).
- Barrido de par√°metros y curva sensibilidad-ruido (opcional).
- Benchmark ORB vs SIFT (opcional).
- Dashboard QA con alertas (opcional).

---

## üìö Referencias

- OpenCV Documentation ‚Äì Feature Detection (SIFT y ORB).
- scikit-image User Guide ‚Äì Contrast Enhancement & Edge Detection.
- Documentaci√≥n oficial de ORB/SIFT y estrategias de repetibilidad en visi√≥n por computadora.